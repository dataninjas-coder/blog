<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>[WPF] Creating parameterized styles with attached properties - Thomas Levesque&#39;s .NET Blog</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	
	
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">
	<link rel="stylesheet" href="/css/style.css">
	
	<link rel="shortcut icon" href="/favicon.ico">
		
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-31621259-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container">
		<div class="logo">
			<a class="logo__link" href="/" title="Thomas Levesque&#39;s .NET Blog" rel="home">
				<div class="logo__title">Thomas Levesque&#39;s .NET Blog</div>
				
			</a>
		</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">Menu</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/about/">
				
				<span class="menu__text">About</span>
				
			</a>
		</li>
	</ul>
</nav>

	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">[WPF] Creating parameterized styles with attached properties</h1>
			
		</header><div class="content post__content clearfix">
			<p>Today I&rsquo;d like to share a trick that I used quite often in the past few months. Let&rsquo;s assume that in order to improve the look of your application, you created custom styles for the standard controls:  <img src="parameterized_styles11.png" alt="">  OK, I&rsquo;m not a designer&hellip; but it will serve the purpose well enough to illustrate my point ;). These styles are very simple, they&rsquo;re just the default styles of <code>CheckBox</code> and <code>RadioButton</code> in which I only changed the templates to replace the <code>BulletChrome</code>s with these awesome blue tick marks. Here&rsquo;s the code:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml">        <span style="color:#f92672">&lt;Style</span> <span style="color:#a6e22e">x:Key=</span><span style="color:#e6db74">&#34;{x:Type CheckBox}&#34;</span> <span style="color:#a6e22e">TargetType=</span><span style="color:#e6db74">&#34;{x:Type CheckBox}&#34;</span><span style="color:#f92672">&gt;</span>
            <span style="color:#f92672">&lt;Setter</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;Foreground&#34;</span> <span style="color:#a6e22e">Value=</span><span style="color:#e6db74">&#34;{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}&#34;</span><span style="color:#f92672">/&gt;</span>
            <span style="color:#f92672">&lt;Setter</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;Background&#34;</span> <span style="color:#a6e22e">Value=</span><span style="color:#e6db74">&#34;{StaticResource CheckBoxFillNormal}&#34;</span><span style="color:#f92672">/&gt;</span>
            <span style="color:#f92672">&lt;Setter</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;BorderBrush&#34;</span> <span style="color:#a6e22e">Value=</span><span style="color:#e6db74">&#34;{StaticResource CheckBoxStroke}&#34;</span><span style="color:#f92672">/&gt;</span>
            <span style="color:#f92672">&lt;Setter</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;BorderThickness&#34;</span> <span style="color:#a6e22e">Value=</span><span style="color:#e6db74">&#34;1&#34;</span><span style="color:#f92672">/&gt;</span>
            <span style="color:#f92672">&lt;Setter</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;FocusVisualStyle&#34;</span> <span style="color:#a6e22e">Value=</span><span style="color:#e6db74">&#34;{StaticResource EmptyCheckBoxFocusVisual}&#34;</span><span style="color:#f92672">/&gt;</span>
            <span style="color:#f92672">&lt;Setter</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;Template&#34;</span><span style="color:#f92672">&gt;</span>
                <span style="color:#f92672">&lt;Setter.Value&gt;</span>
                    <span style="color:#f92672">&lt;ControlTemplate</span> <span style="color:#a6e22e">TargetType=</span><span style="color:#e6db74">&#34;{x:Type CheckBox}&#34;</span><span style="color:#f92672">&gt;</span>
                        <span style="color:#f92672">&lt;BulletDecorator</span> <span style="color:#a6e22e">Background=</span><span style="color:#e6db74">&#34;Transparent&#34;</span>
                                         <span style="color:#a6e22e">SnapsToDevicePixels=</span><span style="color:#e6db74">&#34;true&#34;</span><span style="color:#f92672">&gt;</span>
                            <span style="color:#f92672">&lt;BulletDecorator.Bullet&gt;</span>
                                <span style="color:#f92672">&lt;Border</span> <span style="color:#a6e22e">BorderBrush=</span><span style="color:#e6db74">&#34;{TemplateBinding BorderBrush}&#34;</span>
                                        <span style="color:#a6e22e">Background=</span><span style="color:#e6db74">&#34;{TemplateBinding Background}&#34;</span>
                                        <span style="color:#a6e22e">BorderThickness=</span><span style="color:#e6db74">&#34;1&#34;</span>
                                        <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;11&#34;</span> <span style="color:#a6e22e">Height=</span><span style="color:#e6db74">&#34;11&#34;</span> <span style="color:#a6e22e">Margin=</span><span style="color:#e6db74">&#34;0,1,0,0&#34;</span><span style="color:#f92672">&gt;</span>
                                    <span style="color:#f92672">&lt;Grid&gt;</span>
                                        <span style="color:#f92672">&lt;Path</span> <span style="color:#a6e22e">Name=</span><span style="color:#e6db74">&#34;TickMark&#34;</span>
                                              <span style="color:#a6e22e">Fill=</span><span style="color:#e6db74">&#34;Blue&#34;</span>
                                              <span style="color:#a6e22e">Data=</span><span style="color:#e6db74">&#34;M0,4 5,9 9,0 4,5&#34;</span>
                                              <span style="color:#a6e22e">Visibility=</span><span style="color:#e6db74">&#34;Hidden&#34;</span> <span style="color:#f92672">/&gt;</span>
                                        <span style="color:#f92672">&lt;Rectangle</span> <span style="color:#a6e22e">Name=</span><span style="color:#e6db74">&#34;IndeterminateMark&#34;</span>
                                                   <span style="color:#a6e22e">Fill=</span><span style="color:#e6db74">&#34;Blue&#34;</span>
                                                   <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;7&#34;</span> <span style="color:#a6e22e">Height=</span><span style="color:#e6db74">&#34;7&#34;</span>
                                                   <span style="color:#a6e22e">HorizontalAlignment=</span><span style="color:#e6db74">&#34;Center&#34;</span>
                                                   <span style="color:#a6e22e">VerticalAlignment=</span><span style="color:#e6db74">&#34;Center&#34;</span>
                                                   <span style="color:#a6e22e">Visibility=</span><span style="color:#e6db74">&#34;Hidden&#34;</span> <span style="color:#f92672">/&gt;</span>
                                    <span style="color:#f92672">&lt;/Grid&gt;</span>
                                <span style="color:#f92672">&lt;/Border&gt;</span>
                            <span style="color:#f92672">&lt;/BulletDecorator.Bullet&gt;</span>
                            <span style="color:#f92672">&lt;ContentPresenter</span> <span style="color:#a6e22e">HorizontalAlignment=</span><span style="color:#e6db74">&#34;{TemplateBinding HorizontalContentAlignment}&#34;</span>
                                              <span style="color:#a6e22e">Margin=</span><span style="color:#e6db74">&#34;{TemplateBinding Padding}&#34;</span>
                                              <span style="color:#a6e22e">RecognizesAccessKey=</span><span style="color:#e6db74">&#34;True&#34;</span>
                                              <span style="color:#a6e22e">SnapsToDevicePixels=</span><span style="color:#e6db74">&#34;{TemplateBinding SnapsToDevicePixels}&#34;</span>
                                              <span style="color:#a6e22e">VerticalAlignment=</span><span style="color:#e6db74">&#34;{TemplateBinding VerticalContentAlignment}&#34;</span><span style="color:#f92672">/&gt;</span>
                        <span style="color:#f92672">&lt;/BulletDecorator&gt;</span>
                        <span style="color:#f92672">&lt;ControlTemplate.Triggers&gt;</span>
                            <span style="color:#f92672">&lt;Trigger</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;HasContent&#34;</span> <span style="color:#a6e22e">Value=</span><span style="color:#e6db74">&#34;true&#34;</span><span style="color:#f92672">&gt;</span>
                                <span style="color:#f92672">&lt;Setter</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;FocusVisualStyle&#34;</span> <span style="color:#a6e22e">Value=</span><span style="color:#e6db74">&#34;{StaticResource CheckRadioFocusVisual}&#34;</span><span style="color:#f92672">/&gt;</span>
                                <span style="color:#f92672">&lt;Setter</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;Padding&#34;</span> <span style="color:#a6e22e">Value=</span><span style="color:#e6db74">&#34;4,0,0,0&#34;</span><span style="color:#f92672">/&gt;</span>
                            <span style="color:#f92672">&lt;/Trigger&gt;</span>
                            <span style="color:#f92672">&lt;Trigger</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;IsEnabled&#34;</span> <span style="color:#a6e22e">Value=</span><span style="color:#e6db74">&#34;false&#34;</span><span style="color:#f92672">&gt;</span>
                                <span style="color:#f92672">&lt;Setter</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;Foreground&#34;</span> <span style="color:#a6e22e">Value=</span><span style="color:#e6db74">&#34;{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}&#34;</span><span style="color:#f92672">/&gt;</span>
                            <span style="color:#f92672">&lt;/Trigger&gt;</span>
                            <span style="color:#f92672">&lt;Trigger</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;IsChecked&#34;</span> <span style="color:#a6e22e">Value=</span><span style="color:#e6db74">&#34;True&#34;</span><span style="color:#f92672">&gt;</span>
                                <span style="color:#f92672">&lt;Setter</span> <span style="color:#a6e22e">TargetName=</span><span style="color:#e6db74">&#34;TickMark&#34;</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;Visibility&#34;</span> <span style="color:#a6e22e">Value=</span><span style="color:#e6db74">&#34;Visible&#34;</span> <span style="color:#f92672">/&gt;</span>
                            <span style="color:#f92672">&lt;/Trigger&gt;</span>
                            <span style="color:#f92672">&lt;Trigger</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;IsChecked&#34;</span> <span style="color:#a6e22e">Value=</span><span style="color:#e6db74">&#34;{x:Null}&#34;</span><span style="color:#f92672">&gt;</span>
                                <span style="color:#f92672">&lt;Setter</span> <span style="color:#a6e22e">TargetName=</span><span style="color:#e6db74">&#34;IndeterminateMark&#34;</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;Visibility&#34;</span> <span style="color:#a6e22e">Value=</span><span style="color:#e6db74">&#34;Visible&#34;</span> <span style="color:#f92672">/&gt;</span>
                            <span style="color:#f92672">&lt;/Trigger&gt;</span>
                        <span style="color:#f92672">&lt;/ControlTemplate.Triggers&gt;</span>
                    <span style="color:#f92672">&lt;/ControlTemplate&gt;</span>
                <span style="color:#f92672">&lt;/Setter.Value&gt;</span>
            <span style="color:#f92672">&lt;/Setter&gt;</span>
        <span style="color:#f92672">&lt;/Style&gt;</span>
        <span style="color:#f92672">&lt;Style</span> <span style="color:#a6e22e">x:Key=</span><span style="color:#e6db74">&#34;{x:Type RadioButton}&#34;</span> <span style="color:#a6e22e">TargetType=</span><span style="color:#e6db74">&#34;{x:Type RadioButton}&#34;</span><span style="color:#f92672">&gt;</span>
            <span style="color:#f92672">&lt;Setter</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;Foreground&#34;</span> <span style="color:#a6e22e">Value=</span><span style="color:#e6db74">&#34;{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}&#34;</span><span style="color:#f92672">/&gt;</span>
            <span style="color:#f92672">&lt;Setter</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;Background&#34;</span> <span style="color:#a6e22e">Value=</span><span style="color:#e6db74">&#34;#F4F4F4&#34;</span><span style="color:#f92672">/&gt;</span>
            <span style="color:#f92672">&lt;Setter</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;BorderBrush&#34;</span> <span style="color:#a6e22e">Value=</span><span style="color:#e6db74">&#34;{StaticResource CheckBoxStroke}&#34;</span><span style="color:#f92672">/&gt;</span>
            <span style="color:#f92672">&lt;Setter</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;BorderThickness&#34;</span> <span style="color:#a6e22e">Value=</span><span style="color:#e6db74">&#34;1&#34;</span><span style="color:#f92672">/&gt;</span>
            <span style="color:#f92672">&lt;Setter</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;Template&#34;</span><span style="color:#f92672">&gt;</span>
                <span style="color:#f92672">&lt;Setter.Value&gt;</span>
                    <span style="color:#f92672">&lt;ControlTemplate</span> <span style="color:#a6e22e">TargetType=</span><span style="color:#e6db74">&#34;{x:Type RadioButton}&#34;</span><span style="color:#f92672">&gt;</span>
                        <span style="color:#f92672">&lt;BulletDecorator</span> <span style="color:#a6e22e">Background=</span><span style="color:#e6db74">&#34;Transparent&#34;</span><span style="color:#f92672">&gt;</span>
                            <span style="color:#f92672">&lt;BulletDecorator.Bullet&gt;</span>
                                <span style="color:#f92672">&lt;Grid</span> <span style="color:#a6e22e">VerticalAlignment=</span><span style="color:#e6db74">&#34;Center&#34;</span> <span style="color:#a6e22e">Margin=</span><span style="color:#e6db74">&#34;0,1,0,0&#34;</span><span style="color:#f92672">&gt;</span>
                                    <span style="color:#f92672">&lt;Ellipse</span> <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;11&#34;</span> <span style="color:#a6e22e">Height=</span><span style="color:#e6db74">&#34;11&#34;</span>
                                             <span style="color:#a6e22e">Stroke=</span><span style="color:#e6db74">&#34;{TemplateBinding BorderBrush}&#34;</span>
                                             <span style="color:#a6e22e">StrokeThickness=</span><span style="color:#e6db74">&#34;1&#34;</span>
                                             <span style="color:#a6e22e">Fill=</span><span style="color:#e6db74">&#34;{TemplateBinding Background}&#34;</span> <span style="color:#f92672">/&gt;</span>
                                    <span style="color:#f92672">&lt;Ellipse</span> <span style="color:#a6e22e">Name=</span><span style="color:#e6db74">&#34;TickMark&#34;</span>
                                             <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;7&#34;</span> <span style="color:#a6e22e">Height=</span><span style="color:#e6db74">&#34;7&#34;</span>
                                             <span style="color:#a6e22e">Fill=</span><span style="color:#e6db74">&#34;Blue&#34;</span>
                                             <span style="color:#a6e22e">Visibility=</span><span style="color:#e6db74">&#34;Hidden&#34;</span> <span style="color:#f92672">/&gt;</span>
                                    <span style="color:#f92672">&lt;Ellipse</span> <span style="color:#a6e22e">Name=</span><span style="color:#e6db74">&#34;IndeterminateMark&#34;</span>
                                             <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;3&#34;</span> <span style="color:#a6e22e">Height=</span><span style="color:#e6db74">&#34;3&#34;</span>
                                             <span style="color:#a6e22e">Fill=</span><span style="color:#e6db74">&#34;Blue&#34;</span>
                                             <span style="color:#a6e22e">Visibility=</span><span style="color:#e6db74">&#34;Hidden&#34;</span> <span style="color:#f92672">/&gt;</span>
                                <span style="color:#f92672">&lt;/Grid&gt;</span>
                            <span style="color:#f92672">&lt;/BulletDecorator.Bullet&gt;</span>
                            <span style="color:#f92672">&lt;ContentPresenter</span> <span style="color:#a6e22e">HorizontalAlignment=</span><span style="color:#e6db74">&#34;{TemplateBinding HorizontalContentAlignment}&#34;</span>
                                              <span style="color:#a6e22e">Margin=</span><span style="color:#e6db74">&#34;{TemplateBinding Padding}&#34;</span>
                                              <span style="color:#a6e22e">RecognizesAccessKey=</span><span style="color:#e6db74">&#34;True&#34;</span>
                                              <span style="color:#a6e22e">VerticalAlignment=</span><span style="color:#e6db74">&#34;{TemplateBinding VerticalContentAlignment}&#34;</span><span style="color:#f92672">/&gt;</span>
                        <span style="color:#f92672">&lt;/BulletDecorator&gt;</span>
                        <span style="color:#f92672">&lt;ControlTemplate.Triggers&gt;</span>
                            <span style="color:#f92672">&lt;Trigger</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;HasContent&#34;</span> <span style="color:#a6e22e">Value=</span><span style="color:#e6db74">&#34;true&#34;</span><span style="color:#f92672">&gt;</span>
                                <span style="color:#f92672">&lt;Setter</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;FocusVisualStyle&#34;</span> <span style="color:#a6e22e">Value=</span><span style="color:#e6db74">&#34;{StaticResource CheckRadioFocusVisual}&#34;</span><span style="color:#f92672">/&gt;</span>
                                <span style="color:#f92672">&lt;Setter</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;Padding&#34;</span> <span style="color:#a6e22e">Value=</span><span style="color:#e6db74">&#34;4,0,0,0&#34;</span><span style="color:#f92672">/&gt;</span>
                            <span style="color:#f92672">&lt;/Trigger&gt;</span>
                            <span style="color:#f92672">&lt;Trigger</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;IsEnabled&#34;</span> <span style="color:#a6e22e">Value=</span><span style="color:#e6db74">&#34;false&#34;</span><span style="color:#f92672">&gt;</span>
                                <span style="color:#f92672">&lt;Setter</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;Foreground&#34;</span> <span style="color:#a6e22e">Value=</span><span style="color:#e6db74">&#34;{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}&#34;</span><span style="color:#f92672">/&gt;</span>
                            <span style="color:#f92672">&lt;/Trigger&gt;</span>
                            <span style="color:#f92672">&lt;Trigger</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;IsChecked&#34;</span> <span style="color:#a6e22e">Value=</span><span style="color:#e6db74">&#34;True&#34;</span><span style="color:#f92672">&gt;</span>
                                <span style="color:#f92672">&lt;Setter</span> <span style="color:#a6e22e">TargetName=</span><span style="color:#e6db74">&#34;TickMark&#34;</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;Visibility&#34;</span> <span style="color:#a6e22e">Value=</span><span style="color:#e6db74">&#34;Visible&#34;</span> <span style="color:#f92672">/&gt;</span>
                            <span style="color:#f92672">&lt;/Trigger&gt;</span>
                            <span style="color:#f92672">&lt;Trigger</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;IsChecked&#34;</span> <span style="color:#a6e22e">Value=</span><span style="color:#e6db74">&#34;{x:Null}&#34;</span><span style="color:#f92672">&gt;</span>
                                <span style="color:#f92672">&lt;Setter</span> <span style="color:#a6e22e">TargetName=</span><span style="color:#e6db74">&#34;IndeterminateMark&#34;</span> <span style="color:#a6e22e">Property=</span><span style="color:#e6db74">&#34;Visibility&#34;</span> <span style="color:#a6e22e">Value=</span><span style="color:#e6db74">&#34;Visible&#34;</span> <span style="color:#f92672">/&gt;</span>
                            <span style="color:#f92672">&lt;/Trigger&gt;</span>
                        <span style="color:#f92672">&lt;/ControlTemplate.Triggers&gt;</span>
                    <span style="color:#f92672">&lt;/ControlTemplate&gt;</span>
                <span style="color:#f92672">&lt;/Setter.Value&gt;</span>
            <span style="color:#f92672">&lt;/Setter&gt;</span>
        <span style="color:#f92672">&lt;/Style&gt;</span>
</code></pre></div><p>OK, so you now have beautiful controls that are going to make the app a big success, management is happy, everything is for the best&hellip; until you realize that in another view of the application, the controls need to have the same style, but with green tick marks!  The first solution that comes to mind is to duplicate the style, and replace blue with green in the copy. But since you&rsquo;re a good developer who cares about best practices, you know that duplicate code is evil: if you ever need to make changes to the style of the blue <code>CheckBox</code>, you will also have to modify the green one&hellip; and perhaps the red one, and the black one, etc. Clearly it would soon become unmanageable. So we need to refactor, but how? Ideally we would pass parameters to the style, but a style is not a method that you can call with various parameters&hellip;  What we need is an extra property that controls the color of the tick marks, so we can bind to this property in the template. A possible approach is to create custom controls that inherit <code>CheckBox</code> and <code>RadioButton</code>, with an extra <code>TickBrush</code> property&hellip; but personnally I don&rsquo;t really like this approach, I always prefer to use the built-in controls when they can fit the bill.  Anyway, there is an easier solution: we just need to create a <code>ThemeProperties</code> class with an attached property of type <code>Brush</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp">    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ThemeProperties</span>
    {
        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> Brush GetTickBrush(DependencyObject obj)
        {
            <span style="color:#66d9ef">return</span> (Brush)obj.GetValue(TickBrushProperty);
        }

        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> SetTickBrush(DependencyObject obj, Brush <span style="color:#66d9ef">value</span>)
        {
            obj.SetValue(TickBrushProperty, <span style="color:#66d9ef">value</span>);
        }

        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">readonly</span> DependencyProperty TickBrushProperty =
            DependencyProperty.RegisterAttached(
                <span style="color:#e6db74">&#34;TickBrush&#34;</span>,
                <span style="color:#66d9ef">typeof</span>(Brush),
                <span style="color:#66d9ef">typeof</span>(ThemeProperties),
                <span style="color:#66d9ef">new</span> FrameworkPropertyMetadata(Brushes.Black));
    }
</code></pre></div><p>We change the templates a bit to replace the hard-coded color with a binding to this property:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml">                                ...

                                <span style="color:#75715e">&lt;!-- CheckBox --&gt;</span>
                                        <span style="color:#f92672">&lt;Path</span> <span style="color:#a6e22e">Name=</span><span style="color:#e6db74">&#34;TickMark&#34;</span>
                                              <span style="color:#a6e22e">Fill=</span><span style="color:#e6db74">&#34;{TemplateBinding my:ThemeProperties.TickBrush}&#34;</span>
                                              <span style="color:#a6e22e">Data=</span><span style="color:#e6db74">&#34;M0,4 5,9 9,0 4,5&#34;</span>
                                              <span style="color:#a6e22e">Visibility=</span><span style="color:#e6db74">&#34;Hidden&#34;</span> <span style="color:#f92672">/&gt;</span>
                                        <span style="color:#f92672">&lt;Rectangle</span> <span style="color:#a6e22e">Name=</span><span style="color:#e6db74">&#34;IndeterminateMark&#34;</span>
                                                   <span style="color:#a6e22e">Fill=</span><span style="color:#e6db74">&#34;{TemplateBinding my:ThemeProperties.TickBrush}&#34;</span>
                                                   <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;7&#34;</span> <span style="color:#a6e22e">Height=</span><span style="color:#e6db74">&#34;7&#34;</span>
                                                   <span style="color:#a6e22e">HorizontalAlignment=</span><span style="color:#e6db74">&#34;Center&#34;</span>
                                                   <span style="color:#a6e22e">VerticalAlignment=</span><span style="color:#e6db74">&#34;Center&#34;</span>
                                                   <span style="color:#a6e22e">Visibility=</span><span style="color:#e6db74">&#34;Hidden&#34;</span> <span style="color:#f92672">/&gt;</span>

                                ...

                                <span style="color:#75715e">&lt;!-- RadioButton --&gt;</span>
                                    <span style="color:#f92672">&lt;Ellipse</span> <span style="color:#a6e22e">Name=</span><span style="color:#e6db74">&#34;TickMark&#34;</span>
                                             <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;7&#34;</span> <span style="color:#a6e22e">Height=</span><span style="color:#e6db74">&#34;7&#34;</span>
                                             <span style="color:#a6e22e">Fill=</span><span style="color:#e6db74">&#34;{TemplateBinding my:ThemeProperties.TickBrush}&#34;</span>
                                             <span style="color:#a6e22e">Visibility=</span><span style="color:#e6db74">&#34;Hidden&#34;</span> <span style="color:#f92672">/&gt;</span>
                                    <span style="color:#f92672">&lt;Ellipse</span> <span style="color:#a6e22e">Name=</span><span style="color:#e6db74">&#34;IndeterminateMark&#34;</span>
                                             <span style="color:#a6e22e">Width=</span><span style="color:#e6db74">&#34;3&#34;</span> <span style="color:#a6e22e">Height=</span><span style="color:#e6db74">&#34;3&#34;</span>
                                             <span style="color:#a6e22e">Fill=</span><span style="color:#e6db74">&#34;{TemplateBinding my:ThemeProperties.TickBrush}&#34;</span>
                                             <span style="color:#a6e22e">Visibility=</span><span style="color:#e6db74">&#34;Hidden&#34;</span> <span style="color:#f92672">/&gt;</span>
</code></pre></div><p>And when we use the controls, we set the property to the desired tick color:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#f92672">&lt;CheckBox</span> <span style="color:#a6e22e">Content=</span><span style="color:#e6db74">&#34;Checked&#34;</span> <span style="color:#a6e22e">IsChecked=</span><span style="color:#e6db74">&#34;True&#34;</span> <span style="color:#a6e22e">my:ThemeProperties.TickBrush=</span><span style="color:#e6db74">&#34;Blue&#34;</span> <span style="color:#f92672">/&gt;</span>
</code></pre></div><p>So we can now have controls that share the same style, but have different colors for the tick mark:  <img src="parameterized_styles42.png" alt="">  Isn&rsquo;t it great? However there is a small problem left: since controls on the same view all use the same tick color, it&rsquo;s not very convenient to repeat the color on each one. It would be nice to be able to specify the color just once, on the root of the view&hellip; Well, as it happens, dependency properties have a nice feature that allows to do exactly that: value inheritance. We just need to specify the <code>Inherits</code> flag in the declaration of the <code>TickBrush</code> property:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp">        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">readonly</span> DependencyProperty TickBrushProperty =
            DependencyProperty.RegisterAttached(
                <span style="color:#e6db74">&#34;TickBrush&#34;</span>,
                <span style="color:#66d9ef">typeof</span>(Brush),
                <span style="color:#66d9ef">typeof</span>(ThemeProperties),
                <span style="color:#66d9ef">new</span> FrameworkPropertyMetadata(Brushes.Black, FrameworkPropertyMetadataOptions.Inherits));
</code></pre></div><p>With this flag, the property becomes &ldquo;ambient&rdquo;: we only need to specify its value on a parent control, and all descendant controls will automatically inherit the value. So if you need a view where all the checkboxes and radiobuttons are red, just set the <code>TickBrush</code> property to <code>Red</code> on the root element of the view.  Obviously this concept can be extended to other cases: actually, every time an element of the template must change based on arbitrary criteria, this technique can be used. It can be a good alternative to duplicating a template when you only need to change a small part of it.</p>

		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/attached-property/" rel="tag">attached property</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/style/" rel="tag">style</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/template/" rel="tag">template</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/wpf/" rel="tag">WPF</a>
		</li>
	</ul>
</div>
		</footer>
	</article>
</main>





			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2020 Thomas Levesque&#39;s .NET Blog.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
</body>
</html>